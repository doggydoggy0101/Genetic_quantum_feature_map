# Genetic quantum feature map

This is an unofficial implementation of automatic generating quantum feature maps for **Quantum Support Vector Machine** by **Genetic Algorithm** from the paper: Automatic design of quantum feature maps.

## Genetic Algorithm
Genetic Algorithm (GA) is a nature-inspired algorithm that has extensively been used to solve optimization problems. It does not guarantee to always find the exact optimal solution; however, it may find a near-optimal solution in a limited time.

>GA is an evolutionary algorithm and is inspired by the process of natural selection.

### Chromosome
A chromosome/DNA is a candidate/potential solution to the problem being solved. We define gates per five bits from binary strings to generate quantum circuits as shown in the figure below.

<img src="https://github.com/doggydoggy0101/Genetic_quantum_feature_map/blob/main/image/encode.png" width="600" height="240">

### Population
A set of solutions participating in the process of optimization is called population. We use the number of CPUs in order to effeiciently multi-process in our example.

### Fitness
This is also consider as objective function or cost function. We pass a solution to this function and this function returns the fitness of that solution. We aim to both **maximize the accuracy** and **minimize the ansatz size**, we define multi-objective fitness function as shown in the figure below.

<img src="https://github.com/doggydoggy0101/Genetic_quantum_feature_map/blob/main/image/fitness.png" width="600" height="240">

### Matting pool 
The matting pool chooses the parents for the next generation. The simplest method is to first determine the pool size and then choose the best chromosomes based on the pool size.

### Crossover operation 
This is the reproduction phase which mimics the sexual reproduction mechanism of natural selection. The genetic information of two individuals called parents selected through matting selection is exchanged to produce new individuals called offspring. We randomly chooses two chromosome from the matting pool as parents for each offspring.

### Mutation operation 
This operator also mimics the biological mutation operator. Although, children inherit 99% of characteristics from their parent but mutation allows to introduce new traits in the genetic information of an individual. We set a probability at 66.6% to randomize a chromosome and simply do a bit flip.

### Generation
We put the parents and offsprings together and form a population for the next generation, which is how the Genetic Algorithm is done.

## Results

### Toy data
We use the moon shape data generated by Sklearn, the datapoints are scaled between [-1,1]. Please check **demo.ipynb** for more information.

<img src="https://github.com/doggydoggy0101/Genetic_quantum_feature_map/blob/main/image/moonshape.png" width="400" height="300">

##### Fitness, gate size, accuracy:

<img src="https://github.com/doggydoggy0101/Genetic_quantum_feature_map/blob/main/image/cost.png" width="600" height="225">

### Comparing kernels
The circuit can be optimized if the gates share the same rotation axis and parameter, and can be combined to a single rotation gate with addition angles. We compare the quantum kernel result with linear kernel and Gaussian kernel, and has perfect accuracy with simple uncorrelated circuit.

<img src="https://github.com/doggydoggy0101/Genetic_quantum_feature_map/blob/main/image/kernels.png" width="600" height="320">

## Reference

[S. Altares-L´opez, A. Ribeiro, J.J. Garc´ıa-Ripoll, Automatic design of
quantum feature maps, Quantum Science and Technology, vol. 6, no. 4, 2021.](https://iopscience.iop.org/article/10.1088/2058-9565/ac1ab1) 

[https://algodaily.com/lessons/introduction-to-genetic-algorithms-in-python](https://algodaily.com/lessons/introduction-to-genetic-algorithms-in-python)
